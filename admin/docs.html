<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Docs - WhatsApp Gateway</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        :root {
            --bs-body-bg-rgb: 248, 249, 250;
        }

        body {
            background-color: rgb(var(--bs-body-bg-rgb));
            transition: background-color 0.3s ease;
        }
        
        [data-bs-theme="dark"] pre code {
            background-color: #212529 !important;
            color: #e9ecef !important;
            border-color: var(--bs-border-color);
        }

        .nav-link {
            cursor: pointer;
        }
    </style>
    <link rel="stylesheet" href="/admin/css/custom.css">
</head>

<body>
    <div id="offcanvas-container"></div>
    <div class="main-content-wrapper">
        <header class="py-3 mb-4 border-bottom">
            <div class="container-fluid d-flex align-items-center">
                <button class="btn btn-primary me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                    <i class="bi bi-list"></i>
                </button>
                <h4 class="mb-0">API Documentation</h4>
            </div>
        </header>

        <main class="container mt-4">
            <section id="api-reference" class="mb-5">
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">API Reference & Examples</h5>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-primary" role="alert">
                            <h6 class="alert-heading"><i class="bi bi-key-fill"></i> Authentication (API v1)</h6>
                            <p>Most API v1 endpoints are protected. You need two pieces of information:</p>
                            <ul>
                                <li><strong>Session ID (`sessionId`):</strong> Identifies the WhatsApp account. Pass this as a query parameter in the URL (e.g., <code>?sessionId=YOUR_SESSION_ID</code>).</li>
                                <li><strong>API Token:</strong> A secret key for your session. Pass this in the request header as a Bearer Token (e.g., <code>Authorization: Bearer YOUR_TOKEN</code>).</li>
                            </ul>
                            You get the token when you create a session.
                        </div>
                        <div class="alert alert-info" role="alert">
                            <h6 class="alert-heading"><i class="bi bi-key-fill"></i> Authentication (API v2)</h6>
                            <p>API v2 uses a simpler authentication method:</p>
                            <ul>
                                <li><strong>API Key (`apikey`):</strong> This is the same as your session's API Token. Pass this as a query parameter or in the request body (e.g., <code>?apikey=YOUR_API_KEY</code>).</li>
                            </ul>
                        </div>

                        <ul class="nav nav-tabs mb-3" id="apiTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="tab-sessions" data-bs-toggle="tab" data-bs-target="#content-sessions" type="button" role="tab">API v1: Sessions</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-pairing" data-bs-toggle="tab" data-bs-target="#content-pairing" type="button" role="tab">API v1: Phone Pairing</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-media" data-bs-toggle="tab" data-bs-target="#content-media" type="button" role="tab">API v1: Media Upload</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-messaging" data-bs-toggle="tab" data-bs-target="#content-messaging" type="button" role="tab">API v1: Messaging</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-webhook" data-bs-toggle="tab" data-bs-target="#content-webhook" type="button" role="tab">API v1: Webhook</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="tab-apiv2" data-bs-toggle="tab" data-bs-target="#content-apiv2" type="button" role="tab">API v2: Send Message</button>
                            </li>
                        </ul>

                        <div class="tab-content" id="apiTabsContent">
                            <!-- API v1: Session Management -->
                            <div class="tab-pane fade show active" id="content-sessions" role="tabpanel">
                                <div class="mb-3">
                                    <strong>Create Session</strong>
                                    <p class="text-muted small">Creates a new session instance. Requires the Master API Key found in your <code>.env</code> file.</p>
                                    <pre><code id="curl-create-session">curl -X POST "http://localhost:3000/api/v1/sessions" \
-H "X-Master-Key: YOUR_MASTER_API_KEY" \
-H "Content-Type: application/json" \
-d 
'{ 
  "sessionId": "myNewSession"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-create-session', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>List All Sessions</strong>
                                    <p class="text-muted small">Retrieves a list of all created sessions and their status. No authentication required.</p>
                                    <pre><code id="curl-list-sessions">curl -X GET "http://localhost:3000/api/v1/sessions"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-list-sessions', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Delete Session</strong>
                                    <p class="text-muted small">Deletes a session and logs it out. Requires the session's API Token.</p>
                                    <pre><code id="curl-delete-session">curl -X DELETE "http://localhost:3000/api/v1/sessions/myNewSession" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-delete-session', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Regenerate API Token</strong>
                                    <p class="text-muted small">Generates a new API Token for an existing session. The old token will be invalidated.</p>
                                    <pre><code id="curl-regen-token">curl -X POST "http://localhost:3000/api/v1/sessions/myNewSession/generate-token" \
-H "Authorization: Bearer YOUR_CURRENT_SESSION_TOKEN"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-regen-token', this)">Copy</button>
                                </div>
                            </div>

                            <!-- API v1: Phone Pairing -->
                            <div class="tab-pane fade" id="content-pairing" role="tabpanel">
                                <div class="alert alert-info"><i class="bi bi-info-circle-fill"></i> This is the recommended way to create new sessions without manual QR code scanning.</div>
                                <div class="mb-3">
                                    <strong>1. Initiate Pairing</strong>
                                    <p class="text-muted small">Request a pairing code for a specific phone number. This will create a new session instance and return its <code>sessionId</code>.</p>
                                    <pre><code id="curl-pair-phone">curl -X POST "http://localhost:3000/api/v1/session/pair-phone" \
-H "Authorization: Bearer YOUR_ADMIN_OR_USER_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "phoneNumber": "6281234567890"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-pair-phone', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>2. Check Pairing Status</strong>
                                    <p class="text-muted small">Poll this endpoint using the <code>sessionId</code> from the previous step. It will eventually return a <code>pairingCode</code>.</p>
                                    <pre><code id="curl-pair-status">curl -X GET "http://localhost:3000/api/v1/session/SESSION_ID_FROM_STEP_1/pair-status" \
-H "Authorization: Bearer YOUR_ADMIN_OR_USER_TOKEN"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-pair-status', this)">Copy</button>
                                    <p class="text-muted small mt-2">Once you get the code, go to WhatsApp on your phone &gt; Linked Devices &gt; Link with phone number, and enter the code.</p>
                                </div>
                            </div>

                            <!-- API v1: Media Upload -->
                            <div class="tab-pane fade" id="content-media" role="tabpanel">
                                <div class="mb-3">
                                    <strong>Upload a File</strong>
                                    <p class="text-muted small">Upload a file (image, document, etc.) to the server to get a <code>mediaId</code>. You can then use this ID to send the file as a message.</p>
                                    <pre><code id="curl-upload-media">curl -X POST "http://localhost:3000/api/v1/media?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-F "file=@/path/to/your/image.jpg"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-upload-media', this)">Copy</button>
                                    <p class="text-muted small mt-2">The response will be a JSON object containing the <code>mediaId</code>, e.g., <code>{"status":"success", "mediaId":"some-random-uuid.jpg", ...}</code>.</p>
                                </div>
                            </div>

                            <!-- API v1: Messaging -->
                            <div class="tab-pane fade" id="content-messaging" role="tabpanel">
                                <div class="mb-3">
                                    <strong>Send Text Message</strong>
                                    <pre><code id="curl-send-text">curl -X POST "http://localhost:3000/api/v1/messages?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "to": "6281234567890",
  "type": "text",
  "text": { "body": "Hello from the API!\n*This is bold text*." }
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-send-text', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Send Image (from URL)</strong>
                                    <pre><code id="curl-send-image-url">curl -X POST "http://localhost:3000/api/v1/messages?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "to": "6281234567890",
  "type": "image",
  "image": {
    "link": "https://picsum.photos/200",
    "caption": "This is a test image."
  }
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-send-image-url', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Send Image (from Uploaded Media)</strong>
                                    <pre><code id="curl-send-image-id">curl -X POST "http://localhost:3000/api/v1/messages?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "to": "6281234567890",
  "type": "image",
  "image": {
    "id": "YOUR_MEDIA_ID_FROM_UPLOAD",
    "caption": "This is from an uploaded file."
  }
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-send-image-id', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Send Document to a Group</strong>
                                    <p class="text-muted small">To send to a group, use the group's JID (e.g., <code>1234567890@g.us</code>) and set <code>recipient_type</code> to <code>group</code>.</p>
                                    <pre><code id="curl-send-doc-group">curl -X POST "http://localhost:3000/api/v1/messages?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "recipient_type": "group",
  "to": "GROUP_JID@g.us",
  "type": "document",
  "document": {
    "link": "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf",
    "filename": "Report.pdf"
  }
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-send-doc-group', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Send Multiple Messages (Batch)</strong>
                                    <p class="text-muted small">Send an array of message objects in a single request.</p>
                                    <pre><code id="curl-send-batch">curl -X POST "http://localhost:3000/api/v1/messages?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'[
  {
    "to": "6281234567890",
    "type": "text",
    "text": { "body": "Message 1: This is the first message." }
  },
  {
    "to": "6280987654321",
    "type": "text",
    "text": { "body": "Message 2: To a different recipient." }
  }
]'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-send-batch', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Delete a Message</strong>
                                    <p class="text-muted small">Deletes a message you have sent. You need the <code>messageId</code> and the recipient's JID (<code>remoteJid</code>) from the webhook event or the initial send response.</p>
                                    <pre><code id="curl-delete-message">curl -X DELETE "http://localhost:3000/api/v1/message" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "sessionId": "YOUR_SESSION_ID",
  "messageId": "MESSAGE_ID_TO_DELETE",
  "remoteJid": "RECIPIENT_JID"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-delete-message', this)">Copy</button>
                                </div>
                            </div>

                            <!-- API v1: Webhook -->
                            <div class="tab-pane fade" id="content-webhook" role="tabpanel">
                                <div class="mb-3">
                                    <strong>Set Webhook</strong>
                                    <p class="text-muted small">Assigns a URL to receive events (e.g., incoming messages, status changes) for a session.</p>
                                    <pre><code id="curl-set-webhook">curl -X POST "http://localhost:3000/api/v1/webhook" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "sessionId": "YOUR_SESSION_ID",
  "url": "https://your-webhook-receiver.com/events"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-set-webhook', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Get Webhook</strong>
                                    <p class="text-muted small">Retrieves the current webhook URL for a session.</p>
                                    <pre><code id="curl-get-webhook">curl -X GET "http://localhost:3000/api/v1/webhook?sessionId=YOUR_SESSION_ID" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-get-webhook', this)">Copy</button>
                                </div>
                                <div class="mb-3">
                                    <strong>Delete Webhook</strong>
                                    <p class="text-muted small">Removes the webhook for a session.</p>
                                    <pre><code id="curl-delete-webhook">curl -X DELETE "http://localhost:3000/api/v1/webhook" \
-H "Authorization: Bearer YOUR_SESSION_TOKEN" \
-H "Content-Type: application/json" \
-d 
'{ 
  "sessionId": "YOUR_SESSION_ID"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-delete-webhook', this)">Copy</button>
                                </div>
                            </div>

                            <!-- API v2: Send Message -->
                            <div class="tab-pane fade" id="content-apiv2" role="tabpanel">
                                <div class="alert alert-warning"><i class="bi bi-exclamation-triangle-fill"></i> This API version uses a simpler, flat parameter structure and <code>apikey</code> for authentication, similar to other popular WhatsApp APIs.</div>
                                <p><strong>Endpoint:</strong> <code>/api/v2/send-message</code></p>
                                <p><strong>Methods:</strong> <code>GET</code> and <code>POST</code></p>
                                <p><strong>Parameters:</strong></p>
                                <ul>
                                    <li><code>apikey</code> (String, Required): Your session's API Token.</li>
                                    <li><code>mtype</code> (Enum, Required): Type of message. Options: <code>text</code>, <code>image</code>, <code>video</code>, <code>audio</code>, <code>document</code>, <code>sticker</code>.</li>
                                    <li><code>receiver</code> (String, Required): Receiver Phone Number with Country Code (e.g., <code>6281234567890</code>) or Group JID (e.g., <code>1234567890@g.us</code>).</li>
                                    <li><code>text</code> (String, Required if <code>mtype</code> is <code>text</code>): Text message content.</li>
                                    <li><code>url</code> (String, Required if <code>mtype</code> is <code>image</code>, <code>video</code>, <code>audio</code>, <code>document</code>, <code>sticker</code>): URL of the file (e.g., <code>http://domain.com/example.jpg</code>).</li>
                                    <li><code>filename</code> (String, Optional, for <code>document</code>): Custom name for the document sent.</li>
                                    <li><code>caption</code> (String, Optional, for <code>image</code>, <code>video</code>): Caption for the media.</li>
                                </ul>

                                <div class="mb-3">
                                    <strong>Send Text Message (POST)</strong>
                                    <pre><code id="curl-apiv2-send-text-post">curl -X POST "http://localhost:3000/api/v2/send-message" \
-H "Content-Type: application/json" \
-d 
'{ 
  "apikey": "YOUR_API_KEY",
  "mtype": "text",
  "receiver": "6281234567890",
  "text": "Hello from API v2!"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-apiv2-send-text-post', this)">Copy</button>
                                </div>

                                <div class="mb-3">
                                    <strong>Send Image Message (GET)</strong>
                                    <p class="text-muted small">Note: For GET requests, ensure URL parameters are properly URL-encoded.</p>
                                    <pre><code id="curl-apiv2-send-image-get">curl -X GET "http://localhost:3000/api/v2/send-message?apikey=YOUR_API_KEY&mtype=image&receiver=6281234567890&url=https://picsum.photos/200&caption=Image%20from%20API%20v2"</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-apiv2-send-image-get', this)">Copy</button>
                                </div>

                                <div class="mb-3">
                                    <strong>Send Document Message (POST)</strong>
                                    <pre><code id="curl-apiv2-send-doc-post">curl -X POST "http://localhost:3000/api/v2/send-message" \
-H "Content-Type: application/json" \
-d 
'{ 
  "apikey": "YOUR_API_KEY",
  "mtype": "document",
  "receiver": "6281234567890",
  "url": "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf",
  "filename": "APIv2_Document.pdf"
}'</code></pre>
                                    <button class="btn btn-sm btn-outline-secondary" onclick="copyCurl('curl-apiv2-send-doc-post', this)">Copy</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center text-muted py-4">
            <small>WhatsApp Gateway by Ddos-spec</small>
        </footer>
    </div>

    <script src="/admin/js/bootstrap.bundle.min.js"></script>
    <script src="/admin/js/utils.js"></script>
    <script src="/admin/js/auth-check.js"></script>
    <script src="/admin/js/loadNavbar.js"></script>
    <script>
        function copyCurl(elementId, button) {
            const codeElement = document.getElementById(elementId);
            const textToCopy = codeElement.innerText;
            navigator.clipboard.writeText(textToCopy).then(() => {
                const originalText = button.innerHTML;
                button.innerHTML = 'Copied!';
                setTimeout(() => {
                    button.innerHTML = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }
    </script>
</body>
</html>